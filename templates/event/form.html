<!DOCTYPE html>
<html>
    <head>
        {% include "components/head.html" %}
    </head>
    <style>
        form {
    display: flex;
    flex-direction: column;
    gap: 1.5rem; /* Uniform spacing between form groups */
}

/* Style for labels to always appear above inputs */
label {
    display: block;
    font-size: 1rem;
    margin-bottom: 0.5rem;
    color: #e0e0e0; /* Light text color for labels */
}

/* Universal style for input, textarea, and select elements */
input, textarea, select {
    width: 100%; /* Full width */
    padding: 0.75rem; /* Comfortable padding */y
    border: 1px solid #444; /* Subtle border */
    background-color: #2d2d2d; /* Match container's background */
    color: #f0f0f0; /* Light text */
    border-radius: 6px; /* Smooth rounded corners */
    font-size: 1rem; /* Consistent font size */
    transition: border-color 0.3s ease, box-shadow 0.3s ease; /* Smooth focus effects */
}

/* Focus styles for better user experience */
input:focus, textarea:focus, select:focus {
    outline: none; /* Remove default outline */
    border-color: #007bff; /* Highlight border color */
    box-shadow: 0 0 4px rgba(0, 123, 255, 0.6); /* Subtle glow */
}

/* Style for error messages */
.text-danger {
    font-size: 0.875rem; /* Slightly smaller font for errors */
    color: #ff4d4d; /* Noticeable red color for errors */
}

/* Style for buttons */
button {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 6px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s ease, opacity 0.3s ease;
}

button:hover {
    opacity: 0.9;
}

    </style>


<body style="background-color: #1a1a1a; color: #f0f0f0;">

    <header>
        {% include "components/navbar.html" %}
    </header>

    <main class="container justify-content-center align-items-center" style="margin-top: 80px;">
        <div class="container p-4" style="background-color: #2d2d2d; box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.4); border-radius: 12px; width: 90%; max-width: 800px;">
            <h1 class="mb-4 text-center" style="color: #e0e0e0;">Crear Evento</h1>
            <form method="post" enctype="multipart/form-data" novalidate>
                {% csrf_token %}
                
                <!-- Nombre del Evento -->
                <div>
                    <label for="id_nombre">Nombre del Evento</label>
                    {{ form.nombre }}
                    {% for error in form.nombre.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Fotos del Evento -->
                <div>
                    <label for="id_fotos">Fotos del Evento</label>
                    <input type="file" id="id_fotos" name="fotos" multiple accept="image/*" onchange="previewImages(event)">
                    <div id="imagesPreview" class="d-flex mt-2 flex-wrap gap-2"></div>
                    {% for error in form.fotos.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
        
                <!-- Descripción -->
                <div>
                    <label for="id_descripcion">Descripción</label>
                    {{ form.descripcion }}
                    {% for error in form.descripcion.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
        
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="id_fecha_inicio">Fecha de Inicio</label>
                        {{ form.fecha_inicio }}
                        {% for error in form.fecha_inicio.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="id_fecha_fin">Fecha de Fin</label>
                        {{ form.fecha_fin }}
                        {% for error in form.fecha_fin.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>
        
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="pais">Selecciona un País:</label>
                        <select id="pais" name="pais" class="form-select">
                            <option value="">Seleccione un País</option>
                            {% for pais in paises %}
                                <option value="{{ pais.id }}">{{ pais.nombre }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label for="ubicacion">Selecciona una Ubicación:</label>
                        <select id="ubicacion" name="ubicacion" class="form-select">
                            <option value="">Seleccione una Ubicación</option>
                            {% for ubicacion in ubicaciones %}
                                <option value="{{ ubicacion.id }}">{{ ubicacion.nombre }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <!-- Capacidad -->
                <div class="row">
                    <div class="col-md-6 mb-3">
                    <label for="id_capacidad">Capacidad</label>
                    <input type="number" id="id_capacidad" name="capacidad" min="1">
                    {% for error in form.capacidad.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
        
                <!-- Precio de Entrada -->
                <div class="col-md-6 mb-3">
                    <label for="id_precio_entrada">Precio de Entrada</label>
                    <input type="number" id="id_precio_entrada" name="precio_entrada" min="0">
                    {% for error in form.precio_entrada.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
                </div>
                      
                <!-- Botones -->
                <div class="d-flex justify-content-end gap-2">
                    <button type="button" class="btn btn-outline-light">Cancelar</button>
                    <button type="submit" class="btn btn-primary" style="background-color: #007bff; border-color: #007bff;">Guardar</button>
                </div>
            </form>
        </div>
        
    </main>

    <script>
        // Previsualización de imágenes seleccionadas
        function previewImages(event) {
            const previewContainer = document.getElementById('imagesPreview');
            previewContainer.innerHTML = ''; // Limpiar previas imágenes

            Array.from(event.target.files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.style.maxWidth = '100px';
                    img.style.height = 'auto';
                    img.style.border = '1px solid #ccc';
                    img.style.borderRadius = '8px';
                    previewContainer.appendChild(img);
                };
                reader.readAsDataURL(file);
            });
        }
    </script>

<script>
    document.getElementById('pais').addEventListener('change', function() {
        const paisId = this.value;
        const ubicacionSelect = document.getElementById('ubicacion');
        
        // Limpiar las opciones anteriores de ubicaciones
        ubicacionSelect.innerHTML = '<option value="">Seleccione una Ubicación</option>';
        
        if (paisId) {
            // Usar AJAX para obtener las ubicaciones del país seleccionado
            fetch(`/obtener_ubicaciones/?pais_id=${paisId}`)
                .then(response => response.json())
                .then(data => {
                    // Llenar el combobox de ubicaciones con las nuevas opciones
                    data.forEach(ubicacion => {
                        const option = document.createElement('option');
                        option.value = ubicacion.id;
                        option.textContent = ubicacion.nombre;
                        ubicacionSelect.appendChild(option);
                    });
                })
                .catch(error => console.error('Error al cargar las ubicaciones:', error));
        }
    });
</script>
</body>
</html>
